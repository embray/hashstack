extends: [autotools_package]

sources:
- key: tar.gz:mgzrzaynwn3xo7sboi22etjwmcslzq7u
  url: http://download.zeromq.org/zeromq-4.1.3.tar.gz

build_stages:
  - when: platform == 'Cygwin'
    name: patch
    before: configure
    files: [cygwin_sharedlib.patch]
    handler: bash
    bash: |
      patch -up1 < _hashdist/cygwin_sharedlib.patch

  - name: configure
    extra: ['--with-libsodium=no']

when_build_dependency:
- prepend_path: PATH
  value: '${ARTIFACT}/bin'
- prepend_path: PKG_CONFIG_PATH
  value: '${ARTIFACT}/lib/pkgconfig'
